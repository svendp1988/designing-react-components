{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\_Projects\\\\designing-react-components\\\\src\\\\components\\\\HOC\\\\withRequest.js\";\n\nvar __jsx = React.createElement;\nimport requestReducer, { REQUEST_STATUS } from \"../../reducers/request\";\nimport axios from \"axios\";\nimport { GET_ALL_FAILURE, GET_ALL_SUCCESS, PUT_FAILURE, PUT_SUCCESS } from \"../../actions/request\";\nimport React, { useEffect, useReducer } from \"react\";\n\nvar withRequest = function withRequest(baseUrl, routeName) {\n  return function (Component) {\n    var _s = $RefreshSig$();\n\n    return _s(function () {\n      _s();\n\n      var _useReducer = useReducer(requestReducer, {\n        status: REQUEST_STATUS.LOADING,\n        records: [],\n        error: null\n      }),\n          _useReducer$ = _useReducer[0],\n          records = _useReducer$.records,\n          status = _useReducer$.status,\n          error = _useReducer$.error,\n          dispatch = _useReducer[1];\n\n      useEffect(function () {\n        var fetchSpeakers = /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n            var response;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.prev = 0;\n                    _context.next = 3;\n                    return axios.get(\"http://localhost:4000/speakers\");\n\n                  case 3:\n                    response = _context.sent;\n                    dispatch({\n                      records: response.data,\n                      type: GET_ALL_SUCCESS\n                    });\n                    _context.next = 11;\n                    break;\n\n                  case 7:\n                    _context.prev = 7;\n                    _context.t0 = _context[\"catch\"](0);\n                    console.log(\"Loading data error\", _context.t0);\n                    dispatch({\n                      type: GET_ALL_FAILURE,\n                      error: _context.t0\n                    });\n\n                  case 11:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, null, [[0, 7]]);\n          }));\n\n          return function fetchSpeakers() {\n            return _ref.apply(this, arguments);\n          };\n        }();\n\n        fetchSpeakers();\n      }, []);\n      var props = {\n        records: records,\n        status: status,\n        error: error,\n        put: function () {\n          var _put = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(record) {\n            return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    _context2.prev = 0;\n                    _context2.next = 3;\n                    return axios.put(\"\".concat(baseUrl, \"/\").concat(routeName, \"/\").concat(record.id), record);\n\n                  case 3:\n                    dispatch({\n                      type: PUT_SUCCESS,\n                      record: record\n                    });\n                    _context2.next = 9;\n                    break;\n\n                  case 6:\n                    _context2.prev = 6;\n                    _context2.t0 = _context2[\"catch\"](0);\n                    dispatch({\n                      type: PUT_FAILURE,\n                      error: _context2.t0\n                    });\n\n                  case 9:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2, null, [[0, 6]]);\n          }));\n\n          function put(_x) {\n            return _put.apply(this, arguments);\n          }\n\n          return put;\n        }()\n      };\n      return __jsx(Component, _extends({}, props, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 12\n        }\n      }));\n    }, \"1hwY7Zv7RhlxA65fENwZt5G2ZwY=\");\n  };\n};\n\nexport default withRequest;","map":{"version":3,"sources":["C:/_Projects/designing-react-components/src/components/HOC/withRequest.js"],"names":["requestReducer","REQUEST_STATUS","axios","GET_ALL_FAILURE","GET_ALL_SUCCESS","PUT_FAILURE","PUT_SUCCESS","React","useEffect","useReducer","withRequest","baseUrl","routeName","Component","status","LOADING","records","error","dispatch","fetchSpeakers","get","response","data","type","console","log","props","put","record","id"],"mappings":";;;;;;;;AAAA,OAAOA,cAAP,IAAwBC,cAAxB,QAA6C,wBAA7C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAQC,eAAR,EAAyBC,eAAzB,EAA0CC,WAA1C,EAAuDC,WAAvD,QAAyE,uBAAzE;AACA,OAAOC,KAAP,IAAeC,SAAf,EAA0BC,UAA1B,QAA2C,OAA3C;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,OAAD,EAAUC,SAAV;AAAA,SAAwB,UAACC,SAAD;AAAA;;AAAA,cAAe,YAAM;AAAA;;AAAA,wBAChBJ,UAAU,CAACT,cAAD,EAAgB;AACnEc,QAAAA,MAAM,EAAEb,cAAc,CAACc,OAD4C;AAEnEC,QAAAA,OAAO,EAAE,EAF0D;AAGnEC,QAAAA,KAAK,EAAE;AAH4D,OAAhB,CADM;AAAA;AAAA,UACrDD,OADqD,gBACrDA,OADqD;AAAA,UAC5CF,MAD4C,gBAC5CA,MAD4C;AAAA,UACpCG,KADoC,gBACpCA,KADoC;AAAA,UAC5BC,QAD4B;;AAO7DV,MAAAA,SAAS,CAAC,YAAM;AACZ,YAAMW,aAAa;AAAA,8EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAESjB,KAAK,CAACkB,GAAN,CAAU,gCAAV,CAFT;;AAAA;AAERC,oBAAAA,QAFQ;AAGdH,oBAAAA,QAAQ,CAAC;AACLF,sBAAAA,OAAO,EAAEK,QAAQ,CAACC,IADb;AAELC,sBAAAA,IAAI,EAAEnB;AAFD,qBAAD,CAAR;AAHc;AAAA;;AAAA;AAAA;AAAA;AAQdoB,oBAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACAP,oBAAAA,QAAQ,CAAC;AACLK,sBAAAA,IAAI,EAAEpB,eADD;AAELc,sBAAAA,KAAK;AAFA,qBAAD,CAAR;;AATc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAH;;AAAA,0BAAbE,aAAa;AAAA;AAAA;AAAA,WAAnB;;AAeAA,QAAAA,aAAa;AAChB,OAjBQ,EAiBN,EAjBM,CAAT;AAmBA,UAAMO,KAAK,GAAG;AACVV,QAAAA,OAAO,EAAPA,OADU;AAEVF,QAAAA,MAAM,EAANA,MAFU;AAGVG,QAAAA,KAAK,EAALA,KAHU;AAIVU,QAAAA,GAAG;AAAA,8EAAE,kBAAOC,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAGS1B,KAAK,CAACyB,GAAN,WAAahB,OAAb,cAAwBC,SAAxB,cAAqCgB,MAAM,CAACC,EAA5C,GAAkDD,MAAlD,CAHT;;AAAA;AAIGV,oBAAAA,QAAQ,CAAC;AACLK,sBAAAA,IAAI,EAAEjB,WADD;AAELsB,sBAAAA,MAAM,EAAEA;AAFH,qBAAD,CAAR;AAJH;AAAA;;AAAA;AAAA;AAAA;AASGV,oBAAAA,QAAQ,CAAC;AACLK,sBAAAA,IAAI,EAAElB,WADD;AAELY,sBAAAA,KAAK;AAFA,qBAAD,CAAR;;AATH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAJO,OAAd;AAoBA,aAAO,MAAC,SAAD,eAAeS,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAP;AACH,KA/C2C;AAAA,GAAxB;AAAA,CAApB;;AAiDA,eAAehB,WAAf","sourcesContent":["import requestReducer, {REQUEST_STATUS} from \"../../reducers/request\";\r\nimport axios from \"axios\";\r\nimport {GET_ALL_FAILURE, GET_ALL_SUCCESS, PUT_FAILURE, PUT_SUCCESS} from \"../../actions/request\";\r\nimport React, {useEffect, useReducer} from \"react\";\r\n\r\nconst withRequest = (baseUrl, routeName) => (Component) => () => {\r\n    const [{records, status, error}, dispatch] = useReducer(requestReducer,{\r\n        status: REQUEST_STATUS.LOADING,\r\n        records: [],\r\n        error: null\r\n    });\r\n\r\n    useEffect(() => {\r\n        const fetchSpeakers = async () => {\r\n            try {\r\n                const response = await axios.get(\"http://localhost:4000/speakers\");\r\n                dispatch({\r\n                    records: response.data,\r\n                    type: GET_ALL_SUCCESS\r\n                });\r\n            } catch (e) {\r\n                console.log(\"Loading data error\", e);\r\n                dispatch({\r\n                    type: GET_ALL_FAILURE,\r\n                    error: e\r\n                });\r\n            }\r\n        }\r\n        fetchSpeakers();\r\n    }, []);\r\n\r\n    const props = {\r\n        records,\r\n        status,\r\n        error,\r\n        put: async (record) => {\r\n            try {\r\n\r\n                await axios.put(`${baseUrl}/${routeName}/${record.id}`, record);\r\n                dispatch({\r\n                    type: PUT_SUCCESS,\r\n                    record: record\r\n                });\r\n            } catch (e) {\r\n                dispatch({\r\n                    type: PUT_FAILURE,\r\n                    error: e\r\n                })\r\n            }\r\n        }\r\n    }\r\n    return <Component {...props}/>\r\n};\r\n\r\nexport default withRequest;\r\n"]},"metadata":{},"sourceType":"module"}